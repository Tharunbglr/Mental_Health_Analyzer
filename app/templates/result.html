{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>Personalized Suggestions</h2>
  <div class="summary">
    <p><strong>Name:</strong> {{ summary.name|e }}</p>
    <p><strong>Age:</strong> {{ summary.age }}</p>
    <p><strong>Mood:</strong> {{ summary.mood.title() }}</p>
    <p><strong>Sleep:</strong> {{ summary.sleep_hours }} hours</p>
    <p><strong>Stress:</strong> {{ summary.stress_level }} / 5</p>
  </div>

  <div class="score-cards">
    <div class="score-card">
      <div class="score">PHQ‑9: {{ summary.phq9_score }}</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: {{ (summary.phq9_score / 27) * 100 }}%;"></div>
      </div>
      <div
        class="badge {{ 'normal' if summary.phq9_level == 'Normal' else 'mild' if summary.phq9_level == 'Mild' else 'moderate' if summary.phq9_level == 'Moderate' else 'severe' }}">
        {{ summary.phq9_level }}</div>
    </div>
    <div class="score-card">
      <div class="score">GAD‑7: {{ summary.gad7_score }}</div>
      <div class="progress-bar">
        <div class="progress-fill" style="width: {{ (summary.gad7_score / 21) * 100 }}%;"></div>
      </div>
      <div
        class="badge {{ 'normal' if summary.gad7_level == 'Normal' else 'mild' if summary.gad7_level == 'Mild' else 'moderate' if summary.gad7_level == 'Moderate' else 'severe' }}">
        {{ summary.gad7_level }}</div>
    </div>
  </div>

  <ul class="suggestions">
    {% for s in summary.suggestions %}
    <li>{{ s }}</li>
    {% endfor %}
  </ul>

  {% if ai_feedback %}
  <div class="ai-card">
    <h3>AI-assisted insights</h3>
    <p>{{ ai_feedback }}</p>
  </div>
  {% endif %}

  {% if summary.risk_flag %}
  <div class="alert">
    If you are in immediate danger, call your local emergency number.
  </div>
  {% endif %}

  <div class="actions">
    <a class="button" href="{{ url_for('main.index') }}">Back</a>
  </div>
</section>
{% endblock %}