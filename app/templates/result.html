{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>Personalized Suggestions</h2>
  <div class="summary">
    <p><strong>Name:</strong> {{ summary.name|e }}</p>
    <p><strong>Age:</strong> {{ summary.age }}</p>
    <p><strong>Mood:</strong> {{ summary.mood.title() }}</p>
    <p><strong>Sleep:</strong> {{ summary.sleep_hours }} hours</p>
    <p><strong>Stress:</strong> {{ summary.stress_level }} / 5</p>
  </div>

  <div class="score-cards">
    <div class="score-card">
      <div class="score">PHQ‑9: {{ summary.phq9_score }} / 27</div>
      <div class="progress-bar">
        <div class="progress-fill" data-width="{{ ((summary.phq9_score / 27) * 100) | round(1) }}"></div>
      </div>
      <div
        class="badge {{ 'normal' if summary.phq9_level == 'Minimal' else 'mild' if summary.phq9_level == 'Mild' else 'moderate' if 'Moderate' in summary.phq9_level else 'severe' }}">
        {{ summary.phq9_level }}</div>
    </div>
    <div class="score-card">
      <div class="score">GAD‑7: {{ summary.gad7_score }} / 21</div>
      <div class="progress-bar">
        <div class="progress-fill" data-width="{{ ((summary.gad7_score / 21) * 100) | round(1) }}"></div>
      </div>
      <div
        class="badge {{ 'normal' if summary.gad7_level == 'Minimal' else 'mild' if summary.gad7_level == 'Mild' else 'moderate' if summary.gad7_level == 'Moderate' else 'severe' }}">
        {{ summary.gad7_level }}</div>
    </div>
  </div>

  <div class="interpretation card">
    <h3>How to interpret scores</h3>
    <p class="hint"><strong>PHQ‑9:</strong> 0–4 minimal; 5–9 mild; 10–14 moderate; 15–19 moderately severe; 20–27
      severe.</p>
    <p class="hint"><strong>GAD‑7:</strong> 0–4 minimal; 5–9 mild; 10–14 moderate; 15–21 severe.</p>
    <p class="hint">These tools screen for symptoms — they do not replace clinical assessment. If your scores fall in
      the moderate–severe range, consider reaching out to a healthcare professional or a local mental health service.
    </p>
  </div>

  <ul class="suggestions">
    {% for s in summary.suggestions %}
    <li>{{ s }}</li>
    {% endfor %}
  </ul>

  {% if ai_feedback %}
  <div class="ai-card">
    <h3>AI-assisted insights</h3>
    <p>{{ ai_feedback }}</p>
  </div>
  {% endif %}

  {% if summary.risk_flag %}
  <div class="alert">
    If you are in immediate danger, call your local emergency number.
  </div>
  {% endif %}

  <div class="actions">
    <a class="button" href="{{ url_for('main.index') }}">Back</a>
  </div>
</section>
{% endblock %}